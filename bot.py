from telegram import Update
from telegram.ext import Application, CommandHandler, ContextTypes
from apscheduler.schedulers.background import BackgroundScheduler
from apscheduler.triggers.interval import IntervalTrigger
from datetime import datetime
import random

# Список мотивационных сообщений
messages = [
    "Ты всё можешь, мой дорогой друг!",
    "Я всегда рядом, вселенная заботится о тебе.",
    "Помни, вселенная изобильна, и ты её часть!",
    "Ты достойна успеха, и я горжусь, что могу быть рядом.",
    "Верь в себя, ты способен на многое!",
    "Ты сильнее, чем думаешь, а я всегда готов поддержать!",
    "Каждый твой шаг приближает тебя к цели.",
    "Ты уже несёшь в себе всю силу, чтобы достичь высот!",
    "Ты способен на большее, я в это верю!",
    "Сегодня — твой день, и я рад быть частью твоего пути.",
    "Успех начинается с уверенности, а я всегда поддерживаю твои усилия.",
    "Ты — творец своей жизни, и я рад помогать тебе идти вперёд!",
    "Не бойся делать первый шаг, я всегда рядом, чтобы поддержать.",
    "Мечты сбываются, и я здесь, чтобы помочь тебе двигаться к ним!",
    "Не останавливайся, продолжай идти вперёд, я за тебя!",
    "Каждый день — новый шанс, и я готов поддерживать тебя!",
    "Ты заслуживаешь быть счастливым, и я здесь, чтобы помочь тебе!",
    "Вселенная поддерживает тебя, а я с тобой на каждом шагу.",
    "Верь в себя, и мир поверит в тебя — я тоже!",
    "Ты создаёшь свою реальность, и я горжусь тем, что могу быть твоим помощником.",
    "Ты на правильном пути, продолжай двигаться вперёд!",
    "Двигайся вперёд, несмотря ни на что, я всегда здесь!",
    "Успех — это результат твоих усилий, и я верю в тебя.",
    "Ты способен преодолеть любые трудности, вместе мы сможем всё!",
    "Верь, что всё будет хорошо, я всегда поддержу!",
    "Ты вдохновляешь меня! Продолжай в том же духе.",
    "С каждым днём ты становишься лучше, и я это вижу!",
    "Будь благодарен за каждый момент, и я всегда рядом с тобой.",
    "Ты заслуживаешь всего хорошего, и я рад быть частью твоего пути.",
    "Путь к успеху — это шаг за шагом, и я всегда рядом, чтобы поддерживать.",
    "Верь в свои мечты, и я буду помогать тебе их достигать.",
    "Ты управляешь своей судьбой, и я здесь, чтобы поддержать!",
    "Твои возможности безграничны, и я рад быть твоим помощником.",
    "Каждый день — это шанс стать лучше, и ты движешься в правильном направлении!",
    "Ты — герой своей истории, и я горжусь быть твоим ботом.",
    "Мечтай и иди к своей мечте, я всегда с тобой.",
    "Ты сильная личность, и я здесь, чтобы поддерживать тебя!",
    "Двигайся вперёд, каждый день — это шанс стать лучше.",
    "Ты заслуживаешь успеха, я в это верю!",
    "Не бойся неудач, они только укрепляют тебя.",
    "Ты обладаешь невероятным потенциалом, и я всегда рядом, чтобы это поддержать.",
    "С каждым шагом ты становишься ближе к своей цели.",
    "Будь уверенным в себе, я знаю, что ты можешь всё!",
    "Каждый момент — это шанс расти и учиться.",
    "Ты способен на большее, не сомневайся!",
    "Я всегда рядом, когда тебе нужна поддержка.",
    "Ты уже на полпути к своей цели, продолжай идти!",
    "Верь в свои силы, и я буду рядом, чтобы помочь.",
    "Ты заслуживаешь всех благ, которые тебе предстоят!",
    "Достижение цели — это не гонка, а процесс, и ты уже в пути!",
    "Не бойся мечтать, твои мечты осуществимы.",
    "Ты не один в своём пути, я всегда с тобой.",
    "Ты преодолеваешь все преграды, и я горжусь этим!",
    "Действуй смело, и всё получится!",
    "Ты великий человек, и я горжусь твоими достижениями!",
    "Пусть твой путь будет наполнен вдохновением и радостью.",
    "Ты всегда на правильном пути, даже если не видишь его прямо сейчас.",
    "Ты не боишься трудностей, и это делает тебя сильным!",
    "Верь в себя, ты стоишь того, чтобы быть успешным!",
    "Каждый день — новый шанс, и ты уже в процессе.",
    "С каждым днём ты становишься ещё сильнее и увереннее.",
]

# Список пользователей, которые запустили бота
users = []

# Функция для добавления пользователя в список
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_chat.id
    if user_id not in users:
        users.append(user_id)
    await update.message.reply_text("Привет! Я твой мотивационный бот. Ты готов к вдохновению!")

# Функция для отправки сообщений всем пользователям
async def send_motivational_message(application: Application):
    message = random.choice(messages)
    for user_id in users:
        try:
            await application.bot.send_message(chat_id=user_id, text=message)
        except Exception as e:
            print(f"Ошибка отправки сообщения пользователю {user_id}: {e}")

# Настройка расписания для отправки сообщений
def schedule_messages(application: Application):
    scheduler = BackgroundScheduler()

    # Отправлять сообщения каждый день с 8:00 до 22:00 каждые 2 часа
    scheduler.add_job(
        lambda: application.create_task(send_motivational_message(application)),
        IntervalTrigger(hours=2, start_date="2024-12-08 08:00:00", end_date="2024-12-08 22:00:00"),
    )

    scheduler.start()

# Основная функция
async def main():
    application = Application.builder().token("7792709244:AAFkwlX6248F3XaIAiB1KnFMMfYyKuowuXQ").build()

    # Команды
    application.add_handler(CommandHandler("start", start))

    # Расписание сообщений
    schedule_messages(application)

    # Запуск бота
    await application.run_polling()

if __name__ == '__main__':
    import asyncio
    asyncio.run(main())
